'use strict';

var _interopRequireDefault = require('babel-runtime/helpers/interop-require-default')['default'];

Object.defineProperty(exports, '__esModule', {
  value: true
});
exports['default'] = getRootPath;

var _lodashFind = require('lodash.find');

var _lodashFind2 = _interopRequireDefault(_lodashFind);

var _isMeteorProject = require('./isMeteorProject');

var _isMeteorProject2 = _interopRequireDefault(_isMeteorProject);

var findOneUpwards = require('./findOneUpwards');

function hasFile(parent, filename) {
  return filename.substr(0, parent.length) === parent;
}

// cache for root paths
var rootPaths = [];

function getRootPath(filename) {

  // check whether the project root is already known or not
  var rootPath = (0, _lodashFind2['default'])(rootPaths, function (currentPath) {
    return hasFile(currentPath, filename);
  });

  if (!rootPath) {

    // project root is unkown. search for it
    rootPath = findOneUpwards(filename, _isMeteorProject2['default']);
    rootPaths.push(rootPath);
  }

  return rootPath;
}

module.exports = exports['default'];